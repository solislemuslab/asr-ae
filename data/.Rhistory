# Create model matrix for prediction
x <- model.matrix(abnormal~., train.data)[,-88]
# Create response variable
y <- as.matrix(train.data$abnormal)
# Best lambda
best_lambda <- cv.glmnet(x, y, alpha = 1, family = "binomial")
# Logistic-LASSO model with minimized lambda
best_mod <- glmnet(x, y, family = "binomial", alpha = 1, lambda = best_lambda$lambda.min)
# coef(best_mod)
# Prediction in test data
x.test <- model.matrix(abnormal ~., test.data)[,-88]
probabilities <- best_mod %>% predict(newx = x.test)
predicted.classes <- ifelse(probabilities > 0.5, 1, 0)
# Model accuracy
observed.classes <- test.data$abnormal
# mean(predicted.classes == observed.classes) # 81.82% accuracy
# table of coefficients
lasso_class_vars <- c("MRA", "OSA", "Albumin", "RV Area D", "dCO dVO2", "Epicardial Fat", "RVOT AccT", "NYHA Class 3", "RV FAC", "TLC (L)", "DLCO (%)", "RV FAC")
lasso_class_coefs <- c(-0.400, 0.282, 0.179, -0.043, -0.030, 0.017, 0.002, 0.002, -0.002, 0.017, "< 0.001", "< -0.001")
lasso_class_table <- data.frame(cbind(lasso_class_vars, lasso_class_coefs))
colnames(lasso_class_table) <- c("Variable", "Coefficient")
lasso_class_table |> kbl(booktabs=T,linesep="", digits = 2, row.names=FALSE, caption="Non-Zero Coefficients for Classification Model of Abnormal Change in PVR") |> kable_styling(latex_options=c("striped","HOLD_position"), stripe_index=c(1,2,5:6))
View(lm1)
ex_dat <- raza[,-c(37:41, 44, 46, 49, 50, 64, 65, 75, 77, 78, 82, 87, 88, 99:113, 115:123,125:132, 134)]
ex_dat <- ex_dat[,-c(5,32,33,43,50,57,59,43,72,79)]
# hist(ex_dat$`PVR (WU) (exercise)`)
hist(ex_dat$`PVR (WU) (exercise)`)
ex_outliers <- boxplot(ex_dat$`PVR (WU) (exercise)`, plot=FALSE)$out
ex_dat <- ex_dat[-which(ex_dat$`PVR (WU) (exercise)` %in% ex_outliers),]
hist(perc_dat$`%change PVR`)
# Shapiro-Wilk Test for Normality
shapiro.test(ex_dat$`PVR (WU) (exercise)`) # W=0.93, p<0.001 --> can move forward with normality
hist(perc_dat$`%change PVR`)
hist(ex_dat$`PVR (WU) (exercise)`)
hist(log(ex_dat$`PVR (WU) (exercise)`))
shapiro.test(log(ex_dat$`PVR (WU) (exercise)`)) # W=0.93, p<0.001 --> can move forward with normality
View(food)
z_scale <- scale(ex_dat$`PVR (WU) (exercise)`,center= TRUE, scale=TRUE)
# Shapiro-Wilk Test for Normality
shapiro.test(z_scale) # W=0.93, p<0.001 --> can move forward with normality
summary(ex_dat$`PVR (WU) (exercise)`)
shapiro.test(sqrt(ex_dat$`PVR (WU) (exercise)`)) # W=0.93, p<0.001 --> can move forward with normality
shapiro.test((ex_dat$`PVR (WU) (exercise)`)^(1/3)) # W=0.93, p<0.001 --> can move forward with normality
hist((ex_dat$`PVR (WU) (exercise)`)^(1/3)) # W=0.93, p<0.001 --> can move forward with normality
0.4^(1/3)
1.4^(1/3)
# Shapiro-Wilk Test for Normality
shapiro.test((ex_dat$`PVR (WU) (exercise)`)^(1/3))
ex_dat <- raza[,-c(37:41, 44, 46, 49, 50, 64, 65, 75, 77, 78, 82, 87, 88, 99:113, 115:123,125:132, 134)]
ex_cors <- cor(ex_dat[,-1])
val_ex <- which(abs(ex_cors)>0.8 & row(ex_cors)<col(ex_cors), arr.ind=TRUE)
high_ex_cor <- matrix(colnames(ex_cors)[val_ex],ncol=2)
ex_dat <- ex_dat[,-c(5,32,33,43,50,57,59,43,72,79)]
ex_outliers <- boxplot(ex_dat$`PVR (WU) (exercise)`, plot=FALSE)$out
ex_dat <- ex_dat[-which(ex_dat$`PVR (WU) (exercise)` %in% ex_outliers),]
# Shapiro-Wilk Test for Normality
shapiro.test(ex_dat$`PVR (WU) (exercise)`) # W=0.93, p<0.001 --> not normal
# Shapiro-Wilk Test for Normality
shapiro.test((ex_dat$`PVR (WU) (exercise)`)^(1/3)) #W=0.98, p=0.09 --> normally distributed
ex_dat$`Patient ID` <- as.numeric(ex_dat$`Patient ID`)
ex_dat[c(2,4:19,25:29,69,75:76)] <- lapply(ex_dat[c(2,4:19,25:29,69,75:76)], factor)
ex_dat$`PVR (WU) (exercise)` <- (ex_dat$`PVR (WU) (exercise)`)^(1/3)
# vanilla model for diagnostics
ex_van_mod <- lm(`PVR (WU) (exercise)` ~ ., ex_dat)
summary(ex_van_mod) ##R^2_adj = 0.87
par(mfrow=c(2,2), mar = c(1, 1, 1, 1))
plot(ex_van_mod, which = c(1,2,4,5), cook.levels = 1)
# Remove influential points --> 94 has leverage=1
ex_dat<- ex_dat[-c(30,27,50,72,100),] # remove 3 -- 108 obs left
# Refit vanilla model
ex_van_mod2 <- lm(`PVR (WU) (exercise)` ~ ., ex_dat)
summary(ex_van_mod2) #R^2_adj=0.90
par(mfrow=c(2,2), mar = c(1, 1, 1, 1))
plot(ex_van_mod2, which = c(1,2,4,5), cook.levels = 1)
sub_ex_mod <- regsubsets(`PVR (WU) (exercise)` ~ ., data=ex_dat, method = "forward", really.big=TRUE)
BaseEx_ex <- tidy(sub_ex_mod) ## suggests 10 params best
rsEx_ex <- summary(sub_ex_mod)
BaseEx_ex
view(BaseEx_ex)
par(mfrow=c(1,3))
cplot(2:10, rsEx$bic, ylab="BIC", xlab="Number of Predictors")
par(mfrow=c(1,3))
plot(2:10, rsEx$bic, ylab="BIC", xlab="Number of Predictors")
plot(2:10, rsEx$adjr2, xlab="No. of Parameters", ylab="Adjusted R-square")
plot(2:10, rsEx$cp,xlab="No. of Parameters",ylab="Cp Statistic")
best_mod_ex <- lm(`PVR (WU) (exercise)` ~ `dCO dVO2` + `1Normal 2HFpEF 3PAH` + `TLC (L)` + `Peak O2 pulse (% predicted)` + `Work (watts)` +`PVR (WU) (rest)`, ex_dat)
summary(best_mod_ex)
# build model suggested by regsubsets
best_mod_ex <- lm(`PVR (WU) (exercise)` ~ `dCO dVO2` + (`1Normal 2HFpEF 3PAH`==3) + `TLC (L)` + `Peak O2 pulse (% predicted)` + `Work (watts)` +`PVR (WU) (rest)`, ex_dat)
summary(best_mod_ex)
mod_null_ex <- lm(`PVR (WU) (exercise)` ~ 1, ex_dat)
anova(mod_null_ex, best_mod_ex)
view(ex_dat)
68/119
View(meanAndSd12mo)
# kable output
lm(`%change PVR` ~ `dCO dVO2` + `peak HR` + `Work (watts)` + `E'm` + `DLCO/VA (%)` + `DLCO (%)` + `FEV1/FVC` + BMI + Diuretic, perc_dat) %>%
tidy() %>%
mutate(
p.value = scales::pvalue(p.value),
term = c("Intercept", "dCO2/dVO2", "Peak HR", "Work (watts)", "E'm", "DLCO/VA (%)", "DLCO (%)", "FEV1/FVC", "BMI", "Diuretic = 1")
) %>%
kable(
caption = "Coefficient-Level Estimates for a Model Fitted to % Change in PVR",
col.names = c("Predictor", "B", "SE", "t", "p"),
digits = c(0, 2, 3, 2, 3),
align = c("l", "r", "r", "r", "r")
)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
library(lme4)
library(rstatix)
setwd("~/Desktop/Desktop - Hailey’s MacBook Pro/Grad School/Fall 2023/STAT 727/HW1")
rat <- read.table("ratweight.dat")
colnames(rat) <- c("ID", "Treatment", "0", "1", "2", "3", "4")
rat <- rat |> pivot_longer(cols = c("0", "1", "2", "3", "4"), names_to = "week")
rat$Treatment <- as.factor(rat$Treatment)
rat$ID <- as.character(1:nrow(rat))
rat$week <- as.factor(rat$week)
ggplot(rat, aes(week, value)) + geom_smooth(method=lm, se=FALSE, col="black") + geom_jitter(aes(col=ID), size=0.5) + scale_color_manual(values = getPalette(colourCount)) + xlab("Week") + ylab("Weight (g)") + theme_bw() + theme(legend.position="none")
View(rat)
ggplot(rat, aes(week, value)) + geom_point(aes(color=Treatment)) + geom_smooth(method=lm, se=FALSE, col="black") + scale_color_manual(values = getPalette(colourCount)) + xlab("Week") + ylab("Weight (g)") + theme_bw() + theme(legend.position="none")
#mod <- lmer(value ~ (1 | ID) + Treatment*week, data=rat)
#summary(mod)
ggplot(rat, aes(week, value)) + geom_point(aes(color=Treatment)) + geom_jitter() + geom_smooth(method=lm, se=FALSE, col="black") + scale_color_manual(values = getPalette(colourCount)) + xlab("Week") + ylab("Weight (g)") + theme_bw() + theme(legend.position="none")
#mod <- lmer(value ~ (1 | ID) + Treatment*week, data=rat)
#summary(mod)
ggplot(rat, aes(week, value)) + geom_jitter(aes(color=Treatment)) + geom_smooth(method=lm, se=FALSE, col="black") + scale_color_manual(values = getPalette(colourCount)) + xlab("Week") + ylab("Weight (g)") + theme_bw() + theme(legend.position="none")
#mod <- lmer(value ~ (1 | ID) + Treatment*week, data=rat)
#summary(mod)
ggplot(rat, aes(week, value)) + geom_jitter(aes(color=Treatment)) + geom_smooth(method="lm", se=FALSE, col="black") + scale_color_manual(values = getPalette(colourCount)) + xlab("Week") + ylab("Weight (g)") + theme_bw() + theme(legend.position="none")
#mod <- lmer(value ~ (1 | ID) + Treatment*week, data=rat)
#summary(mod)
ggplot(rat, aes(week, value)) + geom_jitter(aes(color=Treatment)) + geom_smooth(method=lm) + xlab("Week") + ylab("Weight (g)") + theme_bw() + theme(legend.position="none")
#mod <- lmer(value ~ (1 | ID) + Treatment*week, data=rat)
#summary(mod)
ggplot(rat, aes(week, value)) + geom_jitter(aes(color=Treatment)) + geom_smooth(value_week, method=lm) + xlab("Week") + ylab("Weight (g)") + theme_bw() + theme(legend.position="none")
ggplot(rat, aes(week, value)) + geom_jitter(aes(color=Treatment)) + geom_smooth(value~week, method=lm) + xlab("Week") + ylab("Weight (g)") + theme_bw() + theme(legend.position="none")
ggplot(rat, aes(week, value)) + geom_jitter(aes(color=Treatment)) + geom_smooth(formula=value~week, method=lm) + xlab("Week") + ylab("Weight (g)") + theme_bw() + theme(legend.position="none")
#mod <- lmer(value ~ (1 | ID) + Treatment*week, data=rat)
#summary(mod)
class(rat$week)
class(rat$value)
ggplot(rat, aes(week, value)) + geom_jitter(aes(color=Treatment)) + geom_smooth(formula=value~as.numeric(week), method=lm) + xlab("Week") + ylab("Weight (g)") + theme_bw() + theme(legend.position="none")
#mod <- lmer(value ~ (1 | ID) + Treatment*week, data=rat)
#summary(mod)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
library(lme4)
library(rstatix)
setwd("~/Desktop/Desktop - Hailey’s MacBook Pro/Grad School/Fall 2023/STAT 727/HW1")
rat <- read.table("ratweight.dat")
colnames(rat) <- c("ID", "Treatment", "0", "1", "2", "3", "4")
rat <- rat |> pivot_longer(cols = c("0", "1", "2", "3", "4"), names_to = "week")
rat$Treatment <- as.factor(rat$Treatment)
rat$ID <- as.character(1:nrow(rat))
ggplot(rat,aes(week, value, col=Treatment)) + geom_line(aes(group=ID)) + geom_point(aes(shape=Treatment)) + xlab("Week") + ylab("Weight (g)") + labs(title = "Weight Change Over Treatment Within Groups") + scale_color_brewer(palette = "Set1") + theme_bw()
ggplot(rat,aes(as.factor(week), value, col=Treatment)) + geom_line(aes(group=ID)) + geom_point(aes(shape=Treatment)) + xlab("Week") + ylab("Weight (g)") + labs(title = "Weight Change Over Treatment Within Groups") + scale_color_brewer(palette = "Set1") + theme_bw()
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
library(lme4)
library(rstatix)
setwd("~/Desktop/Desktop - Hailey’s MacBook Pro/Grad School/Fall 2023/STAT 727/HW1")
rat <- read.table("ratweight.dat")
colnames(rat) <- c("ID", "Treatment", "0", "1", "2", "3", "4")
rat <- rat |> pivot_longer(cols = c("0", "1", "2", "3", "4"), names_to = "week")
rat$Treatment <- as.factor(rat$Treatment)
ggplot(rat,aes(as.factor(week), value, col=Treatment)) + geom_line(aes(group=ID)) + geom_point(aes(shape=Treatment)) + xlab("Week") + ylab("Weight (g)") + labs(title = "Weight Change Over Treatment Within Groups") + scale_color_brewer(palette = "Set1") + theme_bw()
ggplot(rat, aes(week, value)) + geom_jitter(aes(color=Treatment)) + geom_smooth(method=lm) + xlab("Week") + ylab("Weight (g)") + theme_bw() + theme(legend.position="none")
#mod <- lmer(value ~ (1 | ID) + Treatment*week, data=rat)
#summary(mod)
class(rat$week)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
library(lme4)
library(rstatix)
setwd("~/Desktop/Desktop - Hailey’s MacBook Pro/Grad School/Fall 2023/STAT 727/HW1")
rat <- read.table("ratweight.dat")
colnames(rat) <- c("ID", "Treatment", "0", "1", "2", "3", "4")
rat <- rat |> pivot_longer(cols = c("0", "1", "2", "3", "4"), names_to = "week")
rat$Treatment <- as.factor(rat$Treatment)
rat$week <- as.numeric(rat$week)
ggplot(rat,aes(as.factor(week), value, col=Treatment)) + geom_line(aes(group=ID)) + geom_point(aes(shape=Treatment)) + xlab("Week") + ylab("Weight (g)") + labs(title = "Weight Change Over Treatment Within Groups") + scale_color_brewer(palette = "Set1") + theme_bw()
ggplot(rat, aes(week, value)) + geom_jitter(aes(color=Treatment)) + geom_smooth(method=lm) + xlab("Week") + ylab("Weight (g)") + theme_bw() + theme(legend.position="none")
#mod <- lmer(value ~ (1 | ID) + Treatment*week, data=rat)
#summary(mod)
ggplot(rat, aes(week, value)) + geom_jitter(aes(color=Treatment)) + geom_smooth(method=lm, se=FALSE, color="black") + xlab("Week") + ylab("Weight (g)") + theme_bw() + theme(legend.position="none")
#mod <- lmer(value ~ (1 | ID) + Treatment*week, data=rat)
#summary(mod)
ggplot(rat, aes(week, value)) + geom_jitter(aes(color=Treatment)) + geom_smooth(method=lm, se=FALSE, color="black") + xlab("Week") + ylab("Weight (g)") + scale_color_brewer(palette = "Dark2") + theme_bw() + theme(legend.position="none")
#mod <- lmer(value ~ (1 | ID) + Treatment*week, data=rat)
#summary(mod)
ggplot(rat, aes(week, value)) + geom_jitter(aes(color=Treatment)) + geom_smooth(method=lm, se=FALSE, color="black") + xlab("Week") + ylab("Weight (g)") + scale_color_brewer(palette = "Dark2") + theme_bw() + theme(legend.title = "Treatment")
ggplot(rat, aes(week, value)) + geom_jitter(aes(color=Treatment)) + geom_smooth(method=lm, se=FALSE, color="black") + xlab("Week") + ylab("Weight (g)") + scale_color_brewer(palette = "Dark2") + theme(legend.title = "Treatment") + theme_bw()
#mod <- lmer(value ~ (1 | ID) + Treatment*week, data=rat)
#summary(mod)
ggplot(rat, aes(week, value)) + geom_jitter(aes(color=Treatment)) + geom_smooth(method=lm, se=FALSE, color="black") + xlab("Week") + ylab("Weight (g)") + scale_color_brewer(palette = "Dark2") + theme(legend.title = "Treatment") + ggtitle("Weight Over Time by Treatment Group") + theme_bw()
#mod <- lmer(value ~ (1 | ID) + Treatment*week, data=rat)
#summary(mod)
View(rat)
cor(rat$ID, rat$value)
mod <- lmer(value ~ (1 | ID) + Treatment*week, data=rat)
summary(mod)
vcov(mod)
ggplot(rat, aes(week, value)) + geom_jitter(aes(color=Treatment)) + geom_smooth(method=lm, se=FALSE, color="black") + xlab("Week") + ylab("Weight (g)") + scale_color_brewer(palette = "Dark2") + theme(legend.title = "Treatment") + ggtitle("Weight Over Time by Treatment Group") + theme_bw()
cor_id <- cor(rat$ID, rat$value)
mod <- lmer(value ~ (1 | ID) + Treatment*week, data=rat)
summary(mod)
cov_mat <- vcov(mod)
View(cov_mat)
ggplot(rat, aes(week, value)) + geom_jitter(aes(color=Treatment)) + geom_smooth(method=lm, se=FALSE, color="black") + xlab("Week") + ylab("Weight (g)") + scale_color_brewer(palette = "Dark2") + theme(legend.title = "Treatment") + ggtitle("Weight Over Time by Treatment Group") + theme_bw()
cor_id <- cor(rat$ID, rat$value)
mod <- lmer(value ~ (1 | ID) + Treatment*week, data=rat)
summary(mod)
cov_mat <- data.frame(vcov(mod))
cov_mat <- as.matrix(vcov(mod))
summary(mod)
install.packages("rmcorr")
view(rat)
setwd("~/Desktop/Desktop - Hailey’s MacBook Pro/Grad School/Fall 2023/STAT 727/HW1")
rat <- read.table("ratweight.dat")
colnames(rat) <- c("ID", "Treatment", "0", "1", "2", "3", "4")
View(rat)
rat <- rat |> pivot_longer(cols = c("0", "1", "2", "3", "4"), names_to = "week")
rat$Treatment <- as.factor(rat$Treatment)
rat$week <- as.numeric(rat$week)
rmc.out <- rmcorr(participant=ID,
measure1=week, measure2=value, dataset=rat, CIs = bootstrap, nreps = 100, bstrap.out = F)
library(rmcorr)
rmc.out <- rmcorr(participant=ID,
measure1=week, measure2=value, dataset=rat, CIs = bootstrap, nreps = 100, bstrap.out = F)
class(rat$ID)
rmc.out <- rmcorr(participant=as.character(ID),
measure1=week, measure2=value, dataset=rat, CIs = bootstrap, nreps = 100, bstrap.out = F)
?rmcorr
class(rat$week)
class(rat$value)
rmc.out <- rmcorr(participant=ID,
measure1=Treatment, measure2=as.numeric(value), dataset=rat, CIs = bootstrap, nreps = 100, bstrap.out = F)
rmc.out <- rmcorr(participant=ID,
measure1=as.numeric(Treatment), measure2=as.numeric(value), dataset=rat, CIs = bootstrap, nreps = 100, bstrap.out = F)
rmc.out <- rmcorr(participant=ID,
measure1=as.numeric(Treatment), measure2=as.numeric(value), dataset=rat, CIs = "bootstrap", nreps = 100, bstrap.out = F)
rmc.out <- rmcorr(participant=ID,
measure1=as.numeric(week), measure2=as.numeric(value), dataset=rat, CIs = "bootstrap", nreps = 100, bstrap.out = F)
View(rmc.out)
summary(rmc.out)
rmcorr(participant=ID,
measure1=as.numeric(week), measure2=as.numeric(value), dataset=rat, CIs = "bootstrap", nreps = 100, bstrap.out = F)
r.out <- rmcorr(participant=ID,
measure1=as.numeric(week), measure2=as.numeric(value), dataset=rat, CIs = "bootstrap", nreps = 100, bstrap.out = F)
r.out
?plot.rmc
plot.rmc(r.out, rat, overall=TRUE, xlab="Week", ylab="Value", overall.col="black")
plot(r.out, rat, overall=TRUE, xlab="Week", ylab="Value", overall.col="black")
r.out <- rmcorr(participant=Treatment,
measure1=as.numeric(week), measure2=as.numeric(value), dataset=rat, CIs = "bootstrap", nreps = 100, bstrap.out = F)
plot(r.out, rat, overall=TRUE, xlab="Week", ylab="Value", overall.col="black")
aov(value~Treatment, rat)
summary(aov(value~Treatment, rat))
library(car)
# Levene’s Test for homogeneity of variance
leveneTest(value~Treatment, rate)
# Levene’s Test for homogeneity of variance
leveneTest(value~Treatment, rat)
# ancova model
ancova_model <- aov(value~Treatment+week, rat)
Anova(ancova_model, type="III")
library(multcomp)
install.packages("multcomp")
library(multcomp)
postHocs <- glht(ancova_model, linfct = mcp(technique = "Tukey"))
postHocs <- glht(ancova_model, linfct = mcp(Treatment = "Tukey"))
summary(postHocs)
View(postHocs)
r.out1 <- rmcorr(participant=ID,
measure1=as.numeric(week), measure2=as.numeric(value), dataset=rat, CIs = "bootstrap", nreps = 100, bstrap.out = F)
plot(r.out1, rat, overall=TRUE, xlab="Week", ylab="Value", overall.col="black")
install.packages("seqinr")
library(seqinr)
# Read in files
card1 <- read.fasta("~/Dekstop/asr-ae/data/raxml-ng/data/structaligned_card1.fasta", seqtype = "AA")
# Read in files
card1 <- read.fasta("~/Desktop/asr-ae/data/raxml-ng/data/structaligned_card1.fasta", seqtype = "AA")
View(card1)
# Read in files
card1 <- data.frame(read.fasta("~/Desktop/asr-ae/data/raxml-ng/data/structaligned_card1.fasta", seqtype = "AA"))
class(card1)
drsm1 <- read.fasta("~/Desktop/asr-ae/data/raxml-ng/data/structaligned_drsm1.fasta", seqtype = "AA")
rd1 <- read.fasta("~/Desktop/asr-ae/data/raxml-ng/data/structaligned_rd1.fasta", seqtype = "AA")
View(rd1)
# Concatenate into one file
train_dat <- c(card1, drsm1, rd1)
View(train_dat)
class(train_dat)
summary(train_dat)
library(Biostrings)
library(phylotools)
library(dplyr)
library(tidyr)
library(stringr)
# try with different package
card1 <- readDNAStringSet("~/Desktop/asr-ae/data/raxml-ng/data/structaligned_card1.fasta", seqtype = "AA")
# try with different package
card1 <- readDNAStringSet("~/Desktop/asr-ae/data/raxml-ng/data/structaligned_card1.fasta")
seq_name <- names(card1)
sequence <- paste(card1)
df <- data.frame(seq_name, sequence)
view(df)
library(EnvNJ)
install.packages("EnvNJ")
library(EnvNJ)
card1 <- readDNAStringSet("~/Desktop/asr-ae/data/raxml-ng/data/structaligned_card1.fasta")
seq_name_card1 <- names(card1)
sequence_card1 <- paste(card1)
card1 <- data.frame(seq_name_card1, sequence_card1)
drsm1 <- readDNAStringSet("~/Desktop/asr-ae/data/raxml-ng/data/structaligned_drsm1.fasta")
seq_name_drsm1 <- names(drsm1)
sequence_drsm1 <- paste(drsm1)
drsm1 <- data.frame(seq_name_drsm1, sequence_drsm1)
rd1 <- readDNAStringSet("~/Desktop/asr-ae/data/raxml-ng/data/structaligned_rd1.fasta")
seq_name_rd1 <- names(rd1)
sequence_rd1 <- paste(rd1)
rd1 <- data.frame(seq_name_rd1, sequence_rd1)
train_dat <- rbing(card1, drsm1, rd1)
train_dat <- rbind(card1, drsm1, rd1)
card1 <- readDNAStringSet("~/Desktop/asr-ae/data/raxml-ng/data/structaligned_card1.fasta")
seq_name <- names(card1)
sequence <- paste(card1)
card1 <- data.frame(seq_name_card1, sequence_card1)
drsm1 <- readDNAStringSet("~/Desktop/asr-ae/data/raxml-ng/data/structaligned_drsm1.fasta")
seq_name <- names(drsm1)
sequence <- paste(drsm1)
drsm1 <- data.frame(seq_name_drsm1, sequence_drsm1)
rd1 <- readDNAStringSet("~/Desktop/asr-ae/data/raxml-ng/data/structaligned_rd1.fasta")
seq_name <- names(rd1)
sequence <- paste(rd1)
rd1 <- data.frame(seq_name_rd1, sequence_rd1)
train_dat <- rbind(card1, drsm1, rd1)
view(rd1)
card1 <- readDNAStringSet("~/Desktop/asr-ae/data/raxml-ng/data/structaligned_card1.fasta")
seq_name <- names(card1)
sequence <- paste(card1)
card1 <- data.frame(seq_name, sequence)
drsm1 <- readDNAStringSet("~/Desktop/asr-ae/data/raxml-ng/data/structaligned_drsm1.fasta")
seq_name <- names(drsm1)
sequence <- paste(drsm1)
drsm1 <- data.frame(seq_name, sequence)
rd1 <- readDNAStringSet("~/Desktop/asr-ae/data/raxml-ng/data/structaligned_rd1.fasta")
seq_name <- names(rd1)
sequence <- paste(rd1)
rd1 <- data.frame(seq_name, sequence)
train_dat <- rbind(card1, drsm1, rd1)
View(train_dat)
dat2fasta(train_dat, outfile = "asr-ae-train.fasta")
dat2fasta(train_dat, outfile = "~/Desktop/asr-ae/data/asr-ae-train.fasta")
View(train_dat)
class(ires1_for_repAA)
install.packages("seqRFLP")
library(seqRFLP)
library(seqRFLP)
install.packages("seqRFLP")
writeFasta<-function(data, filename){
fastaLines = c()
for (rowNum in 1:nrow(data)){
fastaLines = c(fastaLines, as.character(paste(">", data[rowNum,"name"], sep = "")))
fastaLines = c(fastaLines,as.character(data[rowNum,"seq"]))
}
fileConn<-file(filename)
writeLines(fastaLines, fileConn)
close(fileConn)
}
writeFasta(train_dat, "~/Desktop/asr-ae/data/asr-ae-train.fasta")
train_dat
# Set wd
setwd("~/Desktop/ViralAncestral/data")
fiveUTR <- readDNAStringSet("./5UTR_Region/picornaviridae2_5UTR_with_outgroup.fasta")
seq_name <- names(fiveUTR)
sequence <- paste(fiveUTR)
df <- data.frame(seq_name, sequence)
# Identify IRES subtypes
ires <- read.table("IRES_list.txt", fill = TRUE, sep = ",", header = FALSE)
ires <- ires %>% separate(V2, c("Name1", "Name2", "Name3", "Name4"))
# Manually impute values for obs that have excess information
ires$Name4[5] <- "IRES5"
ires$Name4[23] <- "IRES1"
ires$Name4[33] <- "IRES0"
ires$Name4[34] <- "IRES0"
ires$Name4[47] <- "IRES0"
ires$Name4[62] <- "IRES2"
ires$Name4[100] <- "IRES2"
# Filtering IRES subtypes
ires0 <- ires %>% filter(Name4 == "IRES0")
ires0$V1 <-gsub(">","",as.character(ires0$V1))
ires1 <- ires %>% filter(Name4 == "IRES1")
ires1$V1 <-gsub(">","",as.character(ires1$V1))
ires2 <- ires %>% filter(Name4 == "IRES2")
ires2$V1 <-gsub(">","",as.character(ires2$V1))
ires3 <- ires %>% filter(Name4 == "IRES3")
ires3$V1 <-gsub(">","",as.character(ires3$V1))
ires4 <- ires %>% filter(Name4 == "IRES4")
ires4$V1 <-gsub(">","",as.character(ires4$V1))
ires5 <- ires %>% filter(Name4 == "IRES5")
ires5$V1 <-gsub(">","",as.character(ires5$V1))
# Make data frames of IRES subtypes
df[c("Main", "Other")] <- str_split_fixed(df$seq_name, '_', 2)
df[c("Other", "Extra")] <- str_split_fixed(df$Other, ',', 2)
ires0[c('Main', 'Other')] <- str_split_fixed(ires0$V1, '_', 2)
df0 <- df %>% filter(Other %in% ires0$Other)
df0 <- df0[,c(1:2)]
ires1[c('Main', 'Other')] <- str_split_fixed(ires1$V1, '_', 2)
df1 <- df %>% filter(Other %in% ires1$Other)
df1 <- df1[,c(1:2)]
ires2[c('Main', 'Other')] <- str_split_fixed(ires2$V1, '_', 2)
df2 <- df %>% filter(Other %in% ires2$Other)
df2 <- df2[,c(1:2)]
ires3[c('Main', 'Other')] <- str_split_fixed(ires3$V1, '_', 2)
df3 <- df %>% filter(Other %in% ires3$Other)
df3 <- df3[,c(1:2)]
ires4[c('Main', 'Other')] <- str_split_fixed(ires4$V1, '_', 2)
df4 <- df %>% filter(Other %in% ires4$Other)
df4 <- df4[,c(1:2)]
ires5[c('Main', 'Other')] <- str_split_fixed(ires5$V1, '_', 2)
df5 <- df %>% filter(Other %in% ires5$Other)
df5 <- df5[,c(1:2)]
# Make new df to create fasta file outputs
newdf <- read.fasta("./5UTR_Region/picornaviridae2_5UTR_with_outgroup.fasta")
# fasta files for IRES type from 5'UTR region
# location of sequences the same between Replicase Gene and 5'UTR Region - so will use for replicase gene too with respect to filtering
ires_0 <- newdf %>% filter(seq_name %in% df0$seq_name)
dat2fasta(ires_0, outfile = "5UTR_ires0_NT.fasta")
ires_1 <- newdf %>% filter(seq_name %in% df1$seq_name)
dat2fasta(ires_1, outfile = "5UTR_ires1_NT.fasta")
ires_2 <- newdf %>% filter(seq_name %in% df2$seq_name)
dat2fasta(ires_2, outfile = "5UTR_ires2_NT.fasta")
ires_3 <- newdf %>% filter(seq_name %in% df3$seq_name)
dat2fasta(ires_3, outfile = "5UTR_ires3_NT.fasta")
ires_4 <- newdf %>% filter(seq_name %in% df4$seq_name)
dat2fasta(ires_4, outfile = "5UTR_ires4_NT.fasta")
ires_5 <- newdf %>% filter(seq_name %in% df5$seq_name)
dat2fasta(ires_5, outfile = "5UTR_ires5_NT.fasta")
## Read in Nucleotides for Replicase Gene
RepNT <- read.fasta("./Replicase_Gene/PRNT.fasta")
RepAA <- read.fasta("./Replicase_Gene/PRAA.fasta")
RepNT_copy <- RepNT
RepAA_copy <- RepAA
## Create data frames for each IRES type - manual identification from previous IRES subsetting
Replicase_ires0_AA <- RepAA_copy[c(6, 7, 8, 22, 23,35, 36, 37, 38, 40, 42, 47, 51, 61, 62, 65, 66, 68, 69),]
Replicase_ires0_NT <- RepNT_copy[c(6, 7, 8, 22, 23,35, 36, 37, 38, 40, 42, 47, 51, 61, 62, 65, 66, 68, 69),]
RepAA_copy <- RepAA_copy[-c(6, 7, 8, 22, 23,35, 36, 37, 38, 40, 42, 47, 51, 61, 62, 65, 66, 68, 69),]
RepNT_copy <- RepNT_copy[-c(6, 7, 8, 22, 23,35, 36, 37, 38, 40, 42, 47, 51, 61, 62, 65, 66, 68, 69),]
row.names(RepAA_copy) <- 1:nrow(RepAA_copy)
row.names(RepNT_copy) <- 1:nrow(RepNT_copy)
ires1_for_repAA <- RepAA_copy[c(1, 2, 4, 5, 6, 7, 8, 10, 27, 38, 43, 47, 52, 55, 64, 65),]
ires1_for_repNT <- RepNT_copy[c(1, 2, 4, 5, 6, 7, 8, 10, 27, 38, 43, 47, 52, 55, 64, 65),]
RepAA_copy <- RepAA_copy[-c(1, 2, 4, 5, 6, 7, 8, 10, 27, 38, 43, 47, 52, 55, 64, 65),]
RepNT_copy <- RepNT_copy[-c(1, 2, 4, 5, 6, 7, 8, 10, 27, 38, 43, 47, 52, 55, 64, 65),]
row.names(RepAA_copy) <- 1:nrow(RepAA_copy)
row.names(RepNT_copy) <- 1:nrow(RepNT_copy)
ires2_for_repAA <- RepAA_copy[c(1, 3, 6, 8, 11, 12, 13, 14, 15, 18, 22, 23, 26, 28, 32, 36, 37, 47),]
ires2_for_repNT <- RepNT_copy[c(1, 3, 6, 8, 11, 12, 13, 14, 15, 18, 22, 23, 26, 28, 32, 36, 37, 47),]
RepAA_copy <- RepAA_copy[-c(1, 3, 6, 8, 11, 12, 13, 14, 15, 18, 22, 23, 26, 28, 32, 36, 37, 47),]
RepNT_copy <- RepNT_copy[-c(1, 3, 6, 8, 11, 12, 13, 14, 15, 18, 22, 23, 26, 28, 32, 36, 37, 47),]
row.names(RepAA_copy) <- 1:nrow(RepAA_copy)
row.names(RepNT_copy) <- 1:nrow(RepNT_copy)
ires3_for_repAA <- RepAA_copy[c(8, 25, 26),]
ires3_for_repNT <- RepNT_copy[c(8, 25, 26),]
RepAA_copy <- RepAA_copy[-c(8, 25, 26),]
RepNT_copy <- RepNT_copy[-c(8, 25, 26),]
row.names(RepAA_copy) <- 1:nrow(RepAA_copy)
row.names(RepNT_copy) <- 1:nrow(RepNT_copy)
ires4_for_repAA <- RepAA_copy[c(4, 5, 7, 10, 11, 12, 16, 20, 21),]
ires4_for_repNT <- RepNT_copy[c(4, 5, 7, 10, 11, 12, 16, 20, 21),]
RepAA_copy <- RepAA_copy[-c(4, 5, 7, 10, 11, 12, 16, 20, 21),]
RepNT_copy <- RepNT_copy[-c(4, 5, 7, 10, 11, 12, 16, 20, 21),]
row.names(RepAA_copy) <- 1:nrow(RepAA_copy)
row.names(RepNT_copy) <- 1:nrow(RepNT_copy)
ires5_for_repAA <- RepAA_copy[c(1, 7, 9),]
ires5_for_repNT <- RepNT_copy[c(1, 7, 9),]
RepAA_copy <- RepAA_copy[-c(1, 7, 9),]
RepNT_copy <- RepNT_copy[-c(1, 7, 9),]
row.names(RepAA_copy) <- 1:nrow(RepAA_copy)
row.names(RepNT_copy) <- 1:nrow(RepNT_copy)
class(RepAA_copy)
class(ires_0)
view(ires_0)
view(ires1_for_repAA)
colnames(train_dat) <- c("seq.name", "seq.text")
dat2fasta(train_dat, outfile = "~/Desktop/asr-ae/data/train_dat.fasta")
setwd("~Desktop/asr-ae/data")
setwd("~/Desktop/asr-ae/data/")
# Read in files
card1 <- read.fasta("./raxml-ng/data/structaligned_card1.fasta", seqtype = "AA")
card1 <- readDNAStringSet("~/Desktop/asr-ae/data/raxml-ng/data/structaligned_card1.fasta")
seq_name <- names(card1)
sequence <- paste(card1)
card1 <- data.frame(seq_name, sequence)
drsm1 <- readDNAStringSet("~/Desktop/asr-ae/data/raxml-ng/data/structaligned_drsm1.fasta")
seq_name <- names(drsm1)
sequence <- paste(drsm1)
drsm1 <- data.frame(seq_name, sequence)
rd1 <- readDNAStringSet("~/Desktop/asr-ae/data/raxml-ng/data/structaligned_rd1.fasta")
seq_name <- names(rd1)
sequence <- paste(rd1)
rd1 <- data.frame(seq_name, sequence)
train_dat <- rbind(card1, drsm1, rd1)
colnames(train_dat) <- c("seq.name", "seq.text")
dat2fasta(train_dat, outfile = "~/Desktop/asr-ae/data/train_dat.fasta")
